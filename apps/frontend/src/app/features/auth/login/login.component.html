<main class="min-h-screen relative flex items-center justify-center p-4 overflow-hidden" role="main">
  <!-- Base gradient background -->
  <div class="absolute inset-0 bg-gradient-to-br from-nwfth-brown via-nwfth-brown/80 to-nwfth-brown/90"></div>

  <!-- Animated gradient morphing overlay -->
  <div class="absolute inset-0 animate-gradient-morph"></div>

  <!-- Multi-layer floating particles system -->
  <div class="absolute inset-0 animate-particles-layer-1"></div>
  <div class="absolute inset-0 animate-particles-layer-2"></div>
  <div class="absolute inset-0 animate-particles-layer-3"></div>

  <!-- Animated glowing orbs -->
  <div class="absolute inset-0 animate-floating-orbs"></div>

  <!-- Mobile Warning (hidden on desktop) -->
  <div class="mobile-warning fixed top-4 left-4 right-4 z-30">
    <p class="font-medium">‚ö†Ô∏è This system is optimized for warehouse tablets and desktop computers. Some features may not work properly on mobile devices.</p>
  </div>

  <!-- Login form content - positioned above all background effects -->
  <div class="nwfth-card login-form-container w-full max-w-md p-8 space-y-6 relative z-20" role="region" aria-labelledby="login-heading">

    <!-- Header with Logo and Title -->
    <div class="text-center space-y-4">
      <div class="flex justify-center">
        <img
          src="assets/images/NWFLogo.jpg"
          alt="Newly Weds Foods Thailand Logo"
          class="h-28 w-auto mx-auto rounded shadow-sm"
          loading="eager" />
      </div>
      <div>
        <h1 id="login-heading" class="text-xl font-bold text-foreground whitespace-nowrap">
          Partial Picking System
        </h1>
      </div>
    </div>

    <!-- Authentication Info -->
    @if (isConnected()) {
      <div class="nwfth-info-box">
        <p class="nwfth-info-title">üîê Dual Authentication Available</p>
        <ul class="nwfth-auth-methods">
          <li>‚úÖ <strong>LDAP/Active Directory</strong> - For domain users</li>
          <li>‚úÖ <strong>Local Database</strong> - For local accounts</li>
        </ul>
        <p class="nwfth-info-note">
          The system will automatically detect and use the appropriate authentication method based on your user configuration.
        </p>
      </div>
    }

    <!-- Login Form -->
    <form
      [formGroup]="loginForm"
      (ngSubmit)="onSubmit()"
      class="space-y-6"
      role="form"
      aria-labelledby="login-heading"
      novalidate>

      <!-- Username Field -->
      <div class="space-y-2">
        <label for="username" class="block text-sm font-bold text-foreground">
          Username
          <span class="text-red-500" aria-label="required">*</span>
        </label>
        <input
          id="username"
          formControlName="username"
          type="text"
          placeholder="Enter your username"
          autocomplete="username"
          spellcheck="false"
          aria-describedby="username-help username-error"
          [attr.aria-invalid]="hasFieldError('username', 'required')"
          (keypress)="onFieldKeyPress($event)"
          class="nwfth-input w-full min-h-touch px-4 py-3 text-base" />

        <!-- Screen reader help text -->
        <div id="username-help" class="sr-only">
          Enter your warehouse system username
        </div>

        <!-- Error message -->
        <div
          id="username-error"
          role="alert"
          aria-live="polite"
          *ngIf="loginForm.get('username')?.touched && loginForm.get('username')?.errors"
          class="text-sm text-red-600 mt-1">
          {{ getFieldErrorMessage('username') }}
        </div>
      </div>

      <!-- Password Field -->
      <div class="space-y-2">
        <label for="password" class="block text-sm font-bold text-foreground">
          Password
          <span class="text-red-500" aria-label="required">*</span>
        </label>
        <input
          id="password"
          type="password"
          formControlName="password"
          placeholder="Enter your password"
          autocomplete="current-password"
          aria-describedby="password-help password-error"
          [attr.aria-invalid]="hasFieldError('password', 'required')"
          (keypress)="onFieldKeyPress($event)"
          class="nwfth-input w-full min-h-touch px-4 py-3 text-base" />

        <!-- Screen reader help text -->
        <div id="password-help" class="sr-only">
          Enter your warehouse system password
        </div>

        <!-- Error message -->
        <div
          id="password-error"
          role="alert"
          aria-live="polite"
          *ngIf="loginForm.get('password')?.touched && loginForm.get('password')?.errors"
          class="text-sm text-red-600 mt-1">
          {{ getFieldErrorMessage('password') }}
        </div>
      </div>

      <!-- Submit Button -->
      <button
        type="submit"
        class="nwfth-button-primary w-full min-h-touch px-6 py-3 flex items-center justify-center gap-2 disabled:opacity-60 disabled:cursor-not-allowed"
        [disabled]="!canSubmit()"
        [attr.aria-describedby]="isLoading() ? 'loading-status' : null">

        <!-- Loading spinner -->
        <div
          *ngIf="isLoading()"
          class="w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"
          aria-hidden="true">
        </div>

        <span>{{ isLoading() ? 'Signing In...' : 'Sign In' }}</span>

        <!-- Loading status for screen readers -->
        <div
          id="loading-status"
          class="sr-only"
          aria-live="polite"
          *ngIf="isLoading()">
          Authentication in progress
        </div>
      </button>

      <!-- Connection Status Alert (moved under Sign In button) -->
      <div class="flex justify-center" *ngIf="connectionStatus() === 'disconnected'">
        <div
          class="relative flex items-center gap-3 px-4 py-2 rounded-lg border-2 font-medium text-sm transition-all duration-300"
          [ngClass]="getConnectionStatusClass()"
          role="status"
          [attr.aria-label]="getConnectionStatusAriaLabel()">

          <!-- Animated Status Indicator -->
          <div class="relative flex items-center">
            <div
              class="w-3 h-3 rounded-full transition-all duration-300"
              [ngClass]="getConnectionStatusIconClass()">
            </div>
          </div>

          <!-- Status Text -->
          <span class="font-semibold">{{ getConnectionStatusText() }}</span>
        </div>
      </div>

    </form>

    <!-- Footer -->
    <div class="text-center text-xs text-muted-foreground mt-6 border-t pt-4">
      <p>Partial Picking v1.0</p>
      <p class="mt-1">&copy; 2025 Newly Weds Foods Thailand</p>
    </div>
  </div>
</main>

<!-- Skip link for keyboard navigation -->
<a
  href="#login-heading"
  class="sr-only absolute left-0 top-0 z-50 bg-background text-foreground p-4 rounded focus:not-sr-only focus:z-auto">
  Skip to main content
</a>

<!-- Keyboard Shortcuts Help (Screen Reader Only) -->
<div class="sr-only" aria-live="polite">
  <p>Use Tab to navigate between form fields. Press Enter to submit the login form when all fields are filled.</p>
</div>